<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-V8ESRHS63N"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-V8ESRHS63N');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QircuitLearn Blog</title>
    <link rel="stylesheet" href="/static/css/landing.css">
</head>
<body>
    <nav class="landing-nav">
        <div class="container nav-container">
            <div class="brand"><a href="/" style="text-decoration:none; color:inherit;">QircuitLearn</a></div>
            <div class="nav-links">
                <a href="/#courses" class="btn sm">Courses</a>
                <a href="/blog" class="btn sm primary">Blog</a>
                {% if user %}
                    <span class="user-welcome">Hi, {{ user }}</span>
                    <a href="/logout" class="btn sm">Logout</a>
                {% else %}
                    <a href="/login" class="btn sm">Login</a>
                    <a href="/register" class="btn sm primary">Register</a>
                {% endif %}
            </div>
        </div>
    </nav>

    <div class="container page-content">
        <div class="forum-header">
            <h1>Latest Articles</h1>
            {% if is_superuser %}
            <a href="/blog/new" class="btn primary">New Article</a>
            {% endif %}
        </div>

        <div class="forum-posts">
            {% if posts %}
                {% for post in posts %}
                <div class="post-card">
                    <div class="post-meta">By {{ post.username }} â€¢ {{ post.created_at }}</div>
                    <div class="post-title">{{ post.title }}</div>
                    <div class="post-content">{{ post.content }}</div>
                    {% if is_superuser %}
                    <div class="post-actions" style="margin-top: 1rem; display: flex; gap: 0.5rem;">
                        <a href="{{ url_for('edit_blog_post', post_id=post.id) }}" class="btn sm secondary">Edit</a>
                        <form action="{{ url_for('delete_blog_post', post_id=post.id) }}" method="POST" onsubmit="return confirm('Are you sure you want to delete this article?');" style="display: inline;">
                            <button type="submit" class="btn sm" style="background: #ef4444; color: white; border: none;">Delete</button>
                        </form>
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
            {% else %}
                <p style="text-align: center; color: var(--text-muted);">No articles yet. Check back soon!</p>
            {% endif %}
        </div>
    </div>
</body>

{% if posts and posts|length > 0 %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Blog",
  "blogPost": [
    {% for post in posts %}
    {
      "@type": "BlogPosting",
      "headline": "{{ post.title }}",
      "datePublished": "{{ post.created_at }}",
      "author": {
        "@type": "Person",
        "name": "{{ post.username }}"
      },
      "articleBody": "{{ post.content | replace('\n',' ') | replace('"','\"') }}"
    }{% if not loop.last %},{% endif %}
    {% endfor %}
  ]
}
</script>
{% endif %}
</html>
